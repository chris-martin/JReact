

package org.jreact.core.impl;

import org.jreact.core.Value;

class LazyConstant<A>
        extends ConstantImpl<A> {

    A value;
    Value<A> container;

    LazyConstant(
            final Value<A> container) {

        this.container = container;

    }

    @Override
    public A get() {

        if (value == null) {
            value = container.get();
            container = null;
        }

        return value;

    }



}







package org.jreact.core.impl;

import fj.Effect;
import fj.F;
import org.jreact.core.Signal;
import org.jreact.core.Value;

public class DisposableConstant<A>
        extends ConstantImpl<A> {

    final Value<A> value;
    boolean disposed;

    DisposableConstant(
            final Value<A> value) {

        this.value = value;

    }

    DisposableConstant(
            final Value<A> value,
            final boolean disposed) {

        this.value = value;
        this.disposed = disposed;

    }

    @Override
    public A get() {

        return value.get();

    }

    void dispose() {

        disposed = true;

    }

    @Override
    public void loop(
            final Effect<? super A> effect) {

        if (value != null) {
            super.loop(effect);
        }

    }

    @Override
    public <B> Signal<B> map(
            final F<A, B> function) {

        if (!disposed) {
            return super.map(function);
        } else {
            return new DisposableConstant<B>
        }

    }

}













package org.jreact.condition;

public abstract class LoopCondition {

    public abstract boolean check();

}











package org.jreact.effect;

import fj.Effect;
import org.A;

public class EmissionEffect<A>
        extends Effect<A> {

    private final Source<A> source;

    public EmissionEffect(
            final Source<A> source) {

        this.source = source;

    }

    @Override
    public void e(
            final A pkg) {

        source.emit(pkg);

    }

}
